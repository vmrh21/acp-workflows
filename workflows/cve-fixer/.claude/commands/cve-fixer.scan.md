# /cve-fixer.scan - Scan Repository for CVE Vulnerabilities

## Purpose
Scans a user-specified repository for known CVE vulnerabilities in dependencies and packages, producing a comprehensive security report with prioritized findings.

## Prerequisites
- User must provide repository URL or local path
- Repository should contain dependency manifests (package.json, requirements.txt, pom.xml, etc.)
- Internet connection for CVE database queries

## Process

1. **Get Repository Information**
   - Ask user: "Which repository would you like to scan? Please provide a GitHub URL or local path."
   - Validate the repository exists and is accessible
   - Identify the repository type and package ecosystem

2. **Detect Dependency Files**
   - Scan for package manifests (package.json, package-lock.json, requirements.txt, Gemfile, etc.)
   - Identify lock files for precise version checking
   - List all detected dependency files for user confirmation

3. **Run Vulnerability Scan**
   - Execute appropriate scanner based on ecosystem (npm audit, pip-audit, etc.)
   - Query CVE databases for known vulnerabilities
   - Collect severity ratings, CVSS scores, and remediation info

4. **Generate Report**
   - Organize findings by severity (Critical → High → Medium → Low)
   - Include CVE IDs, affected packages, current vs. fixed versions
   - Provide actionable remediation steps for each vulnerability
   - Save results to artifacts directory

## Output
- **Scan Results**: `artifacts/cve-fixer/scans/{repo-name}-{timestamp}.json`
  - Complete vulnerability data in structured JSON format
  - Includes CVE IDs, descriptions, severity, CVSS scores, affected versions

- **Security Report**: `artifacts/cve-fixer/reports/{repo-name}-{timestamp}.md`
  - Human-readable markdown report
  - Prioritized list of vulnerabilities with remediation guidance
  - Executive summary with counts by severity level

## Usage Examples

Basic usage:
```
/cve-fixer.scan
```

The command will prompt you for the repository to scan.

With inline repository specification:
```
/cve-fixer.scan https://github.com/owner/repo
```

For local repositories:
```
/cve-fixer.scan /path/to/local/project
```

## Success Criteria

After running this command, you should have:
- [ ] Clear list of all CVE vulnerabilities found
- [ ] Vulnerabilities prioritized by severity
- [ ] Specific version recommendations for fixes
- [ ] Scan results saved to artifacts directory

## Next Steps

After completing this scan:
1. Review the generated report in `artifacts/cve-fixer/reports/`
2. Prioritize critical and high-severity vulnerabilities
3. Plan remediation based on the recommendations
4. (Future) Run `/cve-fixer.fix` to apply automated fixes

## Notes
- Always start by asking for the repository - never assume location
- Different ecosystems require different scanning tools
- Some vulnerabilities may not have patches available yet
- Consider testing fixes in a separate branch before merging
